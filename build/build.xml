<?xml version="1.0"?>
<project name="web-developer" default="build">
	<!-- Custom tasks -->
	<taskdef name="jslint" classname="com.googlecode.jslint4java.ant.JSLintTask" classpath="jslint4java.jar"/>
	<taskdef resource="net/sf/antcontrib/antlib.xml" classpath="ant-contrib.jar"/>

  <!-- Main targets -->
  <target name="all" depends="build,package,test" description="Builds, packages and tests the extension"/>
  <target name="build" depends="build.chrome,build.firefox" description="Builds the extension"/>
	<target name="chrome" depends="build.chrome" description="Builds the extension for Chrome"/>
  <target name="clean" depends="clean.chrome,clean.firefox" description="Cleans up the build"/>
	<target name="firefox" depends="build.firefox" description="Builds the extension for Firefox"/>
	<target name="package" depends="build.firefox,package.chrome" description="Packages the extension"/>

  <!-- Builds the extension for Chrome -->
  <target name="build.chrome" depends="clean.chrome">
    <echo level="info" message="Building the extension for Chrome"/>
    <antcall target="build.chrome.configuration"/>
    <antcall target="build.chrome.about.page"/>
 	  <antcall target="build.chrome.background.page"/>
    <antcall target="build.chrome.content.javascript"/>
    <antcall target="build.chrome.dashboard"/>
    <antcall target="build.chrome.features"/>
    <antcall target="build.chrome.generated.pages"/>
    <antcall target="build.chrome.icons"/>
    <antcall target="build.chrome.locales"/>
    <antcall target="build.chrome.options"/>
    <antcall target="build.chrome.overlay"/>
    <antcall target="build.chrome.toolbars"/>
  </target>

  <!-- Builds the about page for Chrome -->
  <target name="build.chrome.about.page" depends="initialize.chrome">
    <echo level="info" message="Building the about page"/>
    <copy file="../source/common/html/about/about.html" tofile="chrome/about/about.html">
      <filterset refid="chrome.filters"/>
    </copy>
    <concat destfile="chrome/about/javascript/about.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
    	<fileset file="../source/common/javascript/generated/common.js"/>
    	<fileset file="../source/common/javascript/about/about.js"/>
    </concat>
    <concat destfile="chrome/about/about.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/about/about.css"/>
    </concat>
    <copy file="../images/common/logos/16.png" tofile="chrome/about/images/favicon.png"/>
    <copy file="../images/common/logos/64.png" tofile="chrome/about/images/logo.png"/>
	</target>

  <!-- Builds the background page for Chrome -->
  <target name="build.chrome.background.page" depends="initialize.chrome">
    <echo level="info" message="Building the background page"/>
    <copy file="../source/chrome/html/background/background.html" tofile="chrome/background/background.html">
      <filterset refid="chrome.filters"/>
    </copy>
    <concat destfile="chrome/background/javascript/background.temp">
      <fileset file="../source/common/javascript/common/jquery/jquery.js"/>
      <fileset file="../source/common/javascript/common/jquery/icanhaz.js"/>
    	<fileset file="../source/chrome/javascript/background/background.js"/>
      <fileset file="../source/chrome/javascript/locales/locales.js"/>
    	<fileset file="../source/chrome/javascript/storage/storage.js"/>
    	<fileset file="../source/common/javascript/upgrade/upgrade.js"/>
    	<fileset file="../source/chrome/javascript/upgrade/upgrade.js"/>
    </concat>
    <move file="chrome/background/javascript/background.temp" tofile="chrome/background/javascript/background.js">
      <filterset refid="chrome.filters"/>
    </move>
	</target>

  <!-- Builds the configuration for Chrome -->
  <target name="build.chrome.configuration" depends="initialize.chrome">
    <echo level="info" message="Building the configuration"/>
    <copy file="../configuration/chrome/manifest.json" tofile="chrome/manifest.json">
      <filterset refid="chrome.filters"/>
		</copy>
	</target>

  <!-- Builds the content JavaScript for Chrome -->
  <target name="build.chrome.content.javascript" depends="initialize.chrome">
    <echo level="info" message="Building the content JavaScript"/>
    <concat destfile="chrome/content/content.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/common/common.js"/>
    	<fileset file="../source/common/javascript/common/css.js"/>
    	<fileset file="../source/common/javascript/content/content.js"/>
    	<fileset file="../source/chrome/javascript/content/content.js"/>
    </concat>
	</target>

  <!-- Builds the dashboard for Chrome -->
  <target name="build.chrome.dashboard" depends="initialize.chrome">
    <echo level="info" message="Building the dashboard"/>
    <concat destfile="chrome/dashboard/javascript/html/dashboard.js">
      <fileset file="../source/common/javascript/common/jquery/jquery.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/tab.js"/>
    	<fileset file="../source/common/javascript/toolbar/html/element-ancestors.js"/>
    	<fileset file="../source/chrome/javascript/dashboard/common.js"/>
    </concat>
    <concat destfile="chrome/dashboard/javascript/dashboard.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/common/common.js"/>
    	<fileset file="../source/common/javascript/dashboard/dashboard.js"/>
	   	<fileset file="../source/chrome/javascript/dashboard/dashboard.js"/>
    	<fileset file="../source/common/javascript/dashboard/element-information.js"/>
    	<fileset file="../source/chrome/javascript/dashboard/element-information.js"/>
    	<fileset file="../source/common/javascript/dashboard/edit-css.js"/>
    	<fileset file="../source/chrome/javascript/dashboard/edit-css.js"/>
    	<fileset file="../source/common/javascript/toolbar/element-ancestors.js"/>
    	<fileset file="../source/chrome/javascript/toolbar/element-ancestors.js"/>
    </concat>
    <copy file="../source/chrome/style-sheets/dashboard/dashboard.css" tofile="chrome/dashboard/style-sheets/dashboard.css"/>
    <concat destfile="chrome/dashboard/style-sheets/common.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/dashboard/common.css"/>
    	<fileset file="../source/common/style-sheets/dashboard/element-information.css"/>
    	<fileset file="../source/chrome/style-sheets/dashboard/common.css"/>
    </concat>
    <copy file="../images/common/logos/monochrome.png" tofile="chrome/dashboard/images/logo.png"/>
	</target>

  <!-- Builds the features for Chrome -->
  <target name="build.chrome.features" depends="initialize.chrome">
    <echo level="info" message="Building the features"/>
    <concat destfile="chrome/features/javascript/css.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/features/common.js"/>
    	<fileset file="../source/common/javascript/common/css.js"/>
    	<fileset file="../source/common/javascript/features/css.js"/>
    </concat>
    <concat destfile="chrome/features/javascript/forms.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/features/common.js"/>
    	<fileset file="../source/common/javascript/features/forms.js"/>
    </concat>
    <concat destfile="chrome/features/javascript/images.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/features/common.js"/>
    	<fileset file="../source/common/javascript/features/images.js"/>
    </concat>
    <concat destfile="chrome/features/javascript/information.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/features/common.js"/>
    	<fileset file="../source/common/javascript/features/information.js"/>
    </concat>
    <concat destfile="chrome/features/javascript/miscellaneous.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/features/common.js"/>
    	<fileset file="../source/common/javascript/features/miscellaneous.js"/>
    </concat>
    <concat destfile="chrome/features/javascript/outline.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/chrome/javascript/features/common.js"/>
    	<fileset file="../source/common/javascript/features/outline.js"/>
    </concat>
    <copy todir="chrome/features/style-sheets">
      <fileset dir="../source/common/style-sheets/features"/>
    </copy>
    <copy file="../source/common/style-sheets/common/reset.css" tofile="chrome/features/style-sheets/css/disable-browser-default-styles.css"/>
    <copy file="../images/common/transparent.png" tofile="chrome/features/style-sheets/images/transparent.png"/>

    <echo level="info" message="Building the validation features"/>
    <copy todir="chrome/validation">
      <fileset dir="../source/chrome/html/validation"/>
      <filterset refid="chrome.filters"/>
    </copy>
    <copy file="../source/common/javascript/common/jquery/jquery.js" tofile="chrome/validation/javascript/common.js"/>
    <copy todir="chrome/validation/javascript">
      <fileset dir="../source/chrome/javascript/validation"/>
    </copy>
    <concat destfile="chrome/validation/validation.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/generated/common.css"/>
    </concat>
    <copy file="../images/common/logos/16.png" tofile="chrome/validation/images/favicon.png"/>
	</target>

  <!-- Builds the generated pages for Chrome -->
  <target name="build.chrome.generated.pages" depends="initialize.chrome">
    <echo level="info" message="Building the generated pages"/>
    <copy todir="chrome/generated">
      <fileset dir="../source/common/html/generated"/>
      <fileset dir="../source/common/style-sheets/generated">
     		<exclude name="common.css"/>
      </fileset>
      <filterset refid="chrome.filters"/>
    </copy>
    <concat destfile="chrome/generated/javascript/common.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
     	<fileset file="../source/common/javascript/common/jquery/icanhaz.js"/>
	  	<fileset file="../source/common/javascript/common/bootstrap/collapse.js"/>
    	<fileset file="../source/common/javascript/common/bootstrap/dropdown.js"/>
    	<fileset file="../source/chrome/javascript/common/common.js"/>
    	<fileset file="../source/common/javascript/generated/common.js"/>
    </concat>
    <copy file="../source/common/javascript/generated/beautify/beautify.js" tofile="chrome/generated/javascript/beautify/beautify.js"/>
    <concat destfile="chrome/generated/javascript/syntax-highlight-css.js">
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/css.js"/>
    </concat>
    <concat destfile="chrome/generated/javascript/syntax-highlight-javascript.js">
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/javascript.js"/>
    </concat>
    <concat destfile="chrome/generated/javascript/view-cookie-information.js">
      <fileset file="../source/common/javascript/common/bootstrap/modal.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/tooltip.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/popover.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/transition.js"/>
    	<fileset file="../source/common/javascript/generated/view-cookie-information.js"/>
    	<fileset file="../source/chrome/javascript/features/cookies.js"/>
    </concat>
    <copy todir="chrome/generated/javascript">
      <fileset dir="../source/common/javascript/generated">
     		<exclude name="common.js"/>
     		<exclude name="view-cookie-information.js"/>
      </fileset>
    </copy>
    <concat destfile="chrome/generated/common.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/font-awesome.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/generated/common.css"/>
    </concat>
    <concat destfile="chrome/generated/syntax-highlight.css">
    	<fileset file="../source/common/style-sheets/common/codemirror/codemirror.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/theme.css"/>
    </concat>
    <copy file="../images/common/logos/16.png" tofile="chrome/generated/images/favicon.png"/>
    <copy file="../images/common/logos/monochrome.png" tofile="chrome/generated/images/logo.png"/>
    <copy todir="chrome/generated/fonts">
      <fileset dir="../source/common/fonts"/>
    </copy>
	</target>

  <!-- Builds the icons for Chrome -->
  <target name="build.chrome.icons" depends="initialize.chrome">
    <echo level="info" message="Building the icons"/>
    <copy file="../images/common/logos/16.png" tofile="chrome/icons/16.png"/>
    <copy file="../images/common/logos/48.png" tofile="chrome/icons/48.png"/>
    <copy file="../images/common/logos/128.png" tofile="chrome/icons/128.png"/>
	</target>

  <!-- Builds the locales for Chrome -->
  <target name="build.chrome.locales" depends="initialize.chrome">
    <echo level="info" message="Building the locales"/>
    <copy todir="chrome/_locales">
      <fileset dir="../source/chrome/locales"/>
      <filterset refid="chrome.filters"/>
    </copy>
	</target>

  <!-- Builds the options for Chrome -->
  <target name="build.chrome.options" depends="initialize.chrome">
    <echo level="info" message="Building the options"/>
    <copy todir="chrome/options">
    	<fileset file="../source/common/html/options/syntax-highlight.html"/>
    	<fileset file="../source/chrome/html/options/options.html"/>
      <filterset refid="chrome.filters"/>
    </copy>
    <concat destfile="chrome/options/javascript/options.js">
      <fileset file="../source/common/javascript/common/jquery/jquery.js"/>
      <fileset file="../source/common/javascript/common/jquery/icanhaz.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/modal.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/tab.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/transition.js"/>
    	<fileset file="../source/common/javascript/common/common.js"/>
      <fileset file="../source/chrome/javascript/locales/locales.js"/>
      <fileset file="../source/chrome/javascript/options/options.js"/>
      <fileset file="../source/chrome/javascript/options/tablednd.js"/>
      <fileset file="../source/chrome/javascript/storage/storage.js"/>
    </concat>
    <concat destfile="chrome/options/javascript/syntax-highlight.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/css.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/htmlmixed.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/javascript.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/xml.js"/>
    	<fileset file="../source/common/javascript/options/syntax-highlight.js"/>
    </concat>
    <concat destfile="chrome/options/options.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/font-awesome.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/chrome/style-sheets/options/options.css"/>
    </concat>
    <concat destfile="chrome/options/syntax-highlight.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/codemirror.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/theme.css"/>
    	<fileset file="../source/common/style-sheets/options/syntax-highlight.css"/>
    </concat>
    <copy file="../images/common/logos/16.png" tofile="chrome/options/images/favicon.png"/>
    <copy file="../images/common/logos/monochrome.png" tofile="chrome/options/images/logo.png"/>
    <copy file="../images/chrome/options.png" tofile="chrome/options/images/options.png"/>
    <copy todir="chrome/options/fonts">
      <fileset dir="../source/common/fonts"/>
    </copy>
	</target>

  <!-- Builds the overlay for Chrome -->
  <target name="build.chrome.overlay" depends="initialize.chrome">
    <echo level="info" message="Building the overlay"/>
    <copy file="../source/chrome/html/overlay/overlay.html" tofile="chrome/overlay/overlay.html">
      <filterset refid="chrome.filters"/>
    </copy>
    <concat destfile="chrome/overlay/javascript/overlay.temp">
      <fileset file="../source/common/javascript/common/jquery/jquery.js"/>
      <fileset file="../source/common/javascript/common/jquery/icanhaz.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/tab.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/transition.js"/>
      <fileset file="../source/common/javascript/common/common.js"/>
      <fileset file="../source/common/javascript/features/cookies.js"/>
      <fileset file="../source/common/javascript/locales/locales.js"/>
      <fileset dir="../source/common/javascript/overlay"/>
      <fileset file="../source/common/javascript/platform/platform.js"/>
      <fileset file="../source/chrome/javascript/features/cookies.js"/>
      <fileset file="../source/chrome/javascript/locales/locales.js"/>
      <fileset file="../source/chrome/javascript/overlay/overlay.js"/>
      <fileset dir="../source/chrome/javascript/overlay">
     		<exclude name="overlay.js"/>
      </fileset>
    </concat>
    <move file="chrome/overlay/javascript/overlay.temp" tofile="chrome/overlay/javascript/overlay.js">
      <filterset refid="chrome.filters"/>
    </move>
    <concat destfile="chrome/overlay/overlay.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/font-awesome.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/chrome/style-sheets/overlay/overlay.css"/>
    </concat>
    <copy file="../images/common/toolbar.png" tofile="chrome/overlay/images/toolbar.png"/>
    <copy file="../images/chrome/feature.png" tofile="chrome/overlay/images/feature.png"/>
    <copy file="../images/chrome/icon.png" tofile="chrome/overlay/images/icon.png"/>
    <copy todir="chrome/overlay/fonts">
      <fileset dir="../source/common/fonts"/>
    </copy>
	</target>

  <!-- Builds the toolbars for Chrome -->
  <target name="build.chrome.toolbars" depends="initialize.chrome">
    <echo level="info" message="Building the toolbars"/>
   	<copy file="../source/chrome/javascript/toolbar/color-picker.js" tofile="chrome/toolbar/javascript/color-picker.js">
      <filterset refid="chrome.filters"/>
    </copy>
    <concat destfile="chrome/toolbar/javascript/line-guides.js">
    	<fileset file="../source/common/javascript/toolbar/line-guides.js"/>
    	<fileset file="../source/chrome/javascript/toolbar/line-guides.js"/>
    </concat>
    <concat destfile="chrome/toolbar/javascript/ruler.js">
    	<fileset file="../source/common/javascript/toolbar/ruler.js"/>
    	<fileset file="../source/chrome/javascript/toolbar/ruler.js"/>
    </concat>
    <concat destfile="chrome/toolbar/color-picker.css">
    	<fileset file="../source/chrome/style-sheets/toolbar/toolbar.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/color-picker.css"/>
    </concat>
    <concat destfile="chrome/toolbar/color-picker-toolbar.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/common.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/color-picker-toolbar.css"/>
    </concat>
    <copy file="../source/common/style-sheets/toolbar/element-ancestors.css" tofile="chrome/toolbar/element-ancestors.css"/>
    <concat destfile="chrome/toolbar/element-information.css">
    	<fileset file="../source/chrome/style-sheets/toolbar/toolbar.css"/>
    	<fileset file="../source/common/style-sheets/toolbar/element-information.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/element-information.css"/>
    </concat>
    <concat destfile="chrome/toolbar/line-guides.css">
    	<fileset file="../source/chrome/style-sheets/toolbar/toolbar.css"/>
    	<fileset file="../source/common/style-sheets/toolbar/line-guides.css"/>
    </concat>
    <concat destfile="chrome/toolbar/line-guides-toolbar.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/common.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/line-guides.css"/>
    </concat>
    <concat destfile="chrome/toolbar/ruler.css">
    	<fileset file="../source/chrome/style-sheets/toolbar/toolbar.css"/>
    	<fileset file="../source/common/style-sheets/toolbar/ruler.css"/>
    </concat>
    <concat destfile="chrome/toolbar/ruler-toolbar.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/common.css"/>
    	<fileset file="../source/chrome/style-sheets/toolbar/ruler.css"/>
    </concat>
    <copy file="../images/common/logos/monochrome.png" tofile="chrome/toolbar/images/logo.png"/>
	</target>

  <!-- Builds the extension for Firefox -->
  <target name="build.firefox" depends="clean.firefox">
    <echo level="info" message="Building the extension for Firefox"/>
    <antcall target="build.firefox.configuration"/>
    <antcall target="build.firefox.about.page"/>
    <antcall target="build.firefox.common.javascript"/>
    <antcall target="build.firefox.dashboard"/>
    <antcall target="build.firefox.dialogs"/>
    <antcall target="build.firefox.features"/>
    <antcall target="build.firefox.generated.pages"/>
    <antcall target="build.firefox.icons"/>
    <antcall target="build.firefox.locales"/>
    <antcall target="build.firefox.options"/>
    <antcall target="build.firefox.overlay"/>
    <antcall target="build.firefox.skins"/>
    <antcall target="build.firefox.toolbars"/>

    <echo level="info" message="Building the XPI"/>
    <zip destfile="web-developer-firefox.xpi" level="1">
      <zipfileset dir="firefox"/>
      <zipfileset file="license.txt"/>
    </zip>
  </target>

  <!-- Builds the about page for Firefox -->
  <target name="build.firefox.about.page" depends="initialize.firefox">
    <echo level="info" message="Building the about page"/>
    <copy file="../source/common/html/about/about.html" tofile="firefox/content/web-developer/about/about.html">
      <filterset refid="firefox.filters"/>
    </copy>
    <concat destfile="firefox/content/web-developer/about/javascript/about.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
    	<fileset file="../source/common/javascript/generated/common.js"/>
    	<fileset file="../source/common/javascript/about/about.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/about/about.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/about/about.css"/>
    </concat>
    <copy file="../images/common/logos/16.png" tofile="firefox/content/web-developer/about/images/favicon.png"/>
    <copy file="../images/common/logos/64.png" tofile="firefox/content/web-developer/about/images/logo.png"/>
	</target>

  <!-- Builds the common JavaScript for Firefox -->
  <target name="build.firefox.common.javascript" depends="initialize.firefox">
    <echo level="info" message="Building the common JavaScript"/>
    <concat destfile="firefox/content/web-developer/common/common.js">
    	<fileset file="../source/common/javascript/common/common.js"/>
    	<fileset file="../source/firefox/javascript/common/common.js"/>
    </concat>
    <copy file="../source/common/javascript/common/css.js" tofile="firefox/content/web-developer/common/css.js"/>
    <concat destfile="firefox/content/web-developer/content/content.js">
    	<fileset file="../source/common/javascript/content/content.js"/>
    	<fileset file="../source/firefox/javascript/content/content.js"/>
    </concat>
    <copy file="../source/firefox/javascript/preferences/defaults.js" tofile="firefox/defaults/preferences/defaults.js"/>
    <copy file="../source/firefox/javascript/preferences/preferences.js" tofile="firefox/content/web-developer/preferences/preferences.js"/>
    <concat destfile="firefox/content/web-developer/storage/storage.js">
    	<fileset file="../source/common/javascript/storage/storage.js"/>
    	<fileset file="../source/firefox/javascript/storage/storage.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/toolbar/javascript/element-ancestors.js">
    	<fileset file="../source/common/javascript/toolbar/element-ancestors.js"/>
    	<fileset file="../source/firefox/javascript/toolbar/element-ancestors.js"/>
    </concat>
	</target>

  <!-- Builds the configuration for Firefox -->
  <target name="build.firefox.configuration" depends="initialize.firefox">
    <echo level="info" message="Building the configuration"/>
    <copy todir="firefox">
      <fileset file="../configuration/firefox/chrome.manifest"/>
      <fileset file="../configuration/firefox/install.rdf"/>
      <filterset refid="firefox.filters"/>
    </copy>
	</target>

  <!-- Builds the dashboard for Firefox -->
  <target name="build.firefox.dashboard" depends="initialize.firefox">
    <echo level="info" message="Building the dashboard"/>
    <copy todir="firefox/content/web-developer/dashboard">
      <fileset dir="../source/firefox/html/dashboard"/>
      <filterset refid="firefox.filters"/>
    </copy>
    <copy todir="firefox/content/web-developer/dashboard">
      <fileset dir="../source/firefox/xul/dashboard"/>
    </copy>
    <concat destfile="firefox/content/web-developer/dashboard/javascript/dashboard.js">
    	<fileset file="../source/common/javascript/dashboard/dashboard.js"/>
    	<fileset file="../source/firefox/javascript/dashboard/dashboard.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/dashboard/javascript/element-information.js">
    	<fileset file="../source/common/javascript/dashboard/element-information.js"/>
    	<fileset file="../source/firefox/javascript/dashboard/element-information.js"/>
    </concat>
    <copy file="../source/firefox/javascript/dashboard/style-information.js" tofile="firefox/content/web-developer/dashboard/javascript/style-information.js"/>
    <copy file="../source/firefox/javascript/dashboard/edit-html.js" tofile="firefox/content/web-developer/dashboard/javascript/edit-html.js"/>
    <concat destfile="firefox/content/web-developer/dashboard/javascript/edit-css.js">
    	<fileset file="../source/common/javascript/dashboard/edit-css.js"/>
    	<fileset file="../source/firefox/javascript/dashboard/edit-css.js"/>
    </concat>
    <copy todir="firefox/content/web-developer/dashboard/javascript/html">
      <fileset dir="../source/firefox/javascript/dashboard/html">
     		<exclude name="common.js"/>
      </fileset>
    </copy>
    <concat destfile="firefox/content/web-developer/dashboard/javascript/html/common.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
    	<fileset file="../source/common/javascript/generated/common.js"/>
    	<fileset file="../source/firefox/javascript/dashboard/html/common.js"/>
    </concat>
  	<copy file="../source/common/javascript/toolbar/html/element-ancestors.js" tofile="firefox/content/web-developer/dashboard/javascript/html/element-ancestors.js"/>
    <concat destfile="firefox/content/web-developer/dashboard/javascript/html/syntax-highlight-css.js">
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/css.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/searchcursor.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/dashboard/javascript/html/syntax-highlight-html.js">
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/css.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/htmlmixed.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/javascript.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/searchcursor.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/xml.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/dashboard/common.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/codemirror.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/theme.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/dashboard/common.css"/>
    	<fileset file="../source/firefox/style-sheets/dashboard/html/common.css"/>
    </concat>
    <copy file="../source/firefox/style-sheets/dashboard/dashboard.css" tofile="firefox/content/web-developer/dashboard/dashboard.css"/>
    <concat destfile="firefox/content/web-developer/dashboard/element-information.css">
    	<fileset file="../source/common/style-sheets/dashboard/element-information.css"/>
    	<fileset file="../source/firefox/style-sheets/dashboard/html/element-information.css"/>
    </concat>
    <concat destfile="firefox/content/web-developer/dashboard/style-information.css">
    	<fileset file="../source/common/style-sheets/generated/common.css"/>
    	<fileset file="../source/firefox/style-sheets/dashboard/html/style-information.css"/>
    </concat>
	</target>

  <!-- Builds the dialogs for Firefox -->
  <target name="build.firefox.dialogs" depends="initialize.firefox">
    <echo level="info" message="Building the dialogs"/>
    <copy todir="firefox/content/web-developer/dialogs">
      <fileset dir="../source/firefox/xul/dialogs"/>
    </copy>
    <copy todir="firefox/content/web-developer/dialogs/javascript">
      <fileset dir="../source/firefox/javascript/dialogs">
     		<exclude name="dialogs.js"/>
      </fileset>
    </copy>
    <copy todir="firefox/content/web-developer/dialogs/style-sheets">
      <fileset dir="../source/firefox/style-sheets/dialogs"/>
    </copy>
	</target>

  <!-- Builds the features for Firefox -->
  <target name="build.firefox.features" depends="initialize.firefox">
    <echo level="info" message="Building the features"/>
    <copy todir="firefox/content/web-developer/features/style-sheets">
      <fileset dir="../source/common/style-sheets/features"/>
    </copy>
    <copy file="../source/common/style-sheets/common/reset.css" tofile="firefox/content/web-developer/features/style-sheets/css/disable-browser-default-styles.css"/>
    <copy file="../images/common/transparent.png" tofile="firefox/content/web-developer/features/style-sheets/images/transparent.png"/>

    <echo level="info" message="Building the validation features"/>
    <copy todir="firefox/content/web-developer/validation">
      <fileset dir="../source/firefox/html/validation"/>
      <filterset refid="firefox.filters"/>
    </copy>
    <concat destfile="firefox/content/web-developer/validation/validation.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/generated/common.css"/>
    </concat>
    <copy file="../images/common/logos/16.png" tofile="firefox/content/web-developer/validation/images/favicon.png"/>
	</target>

  <!-- Builds the generated pages for Firefox -->
  <target name="build.firefox.generated.pages" depends="initialize.firefox">
    <echo level="info" message="Building the generated pages"/>
    <copy todir="firefox/content/web-developer/generated">
      <fileset dir="../source/common/html/generated"/>
      <fileset dir="../source/firefox/html/generated"/>
      <fileset dir="../source/common/style-sheets/generated">
     		<exclude name="common.css"/>
      </fileset>
      <fileset dir="../source/firefox/style-sheets/generated"/>
      <filterset refid="firefox.filters"/>
    </copy>
    <concat destfile="firefox/content/web-developer/generated/javascript/common.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
    	<fileset file="../source/common/javascript/common/jquery/icanhaz.js"/>
    	<fileset file="../source/common/javascript/common/bootstrap/collapse.js"/>
    	<fileset file="../source/common/javascript/common/bootstrap/dropdown.js"/>
    	<fileset file="../source/firefox/javascript/common/common.js"/>
    	<fileset file="../source/common/javascript/generated/common.js"/>
    	<fileset file="../source/firefox/javascript/generated/common.js"/>
    </concat>
    <copy file="../source/common/javascript/generated/beautify/beautify.js" tofile="firefox/content/web-developer/generated/javascript/beautify/beautify.js"/>
    <concat destfile="firefox/content/web-developer/generated/javascript/syntax-highlight-css.js">
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/css.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/generated/javascript/syntax-highlight-javascript.js">
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/javascript.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/generated/javascript/view-cookie-information.js">
      <fileset file="../source/common/javascript/common/bootstrap/modal.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/tooltip.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/popover.js"/>
      <fileset file="../source/common/javascript/common/bootstrap/transition.js"/>
    	<fileset file="../source/common/javascript/generated/view-cookie-information.js"/>
    	<fileset file="../source/firefox/javascript/features/cookies.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/generated/javascript/view-document-size.js">
    	<fileset file="../source/firefox/javascript/generated/view-document-size.js"/>
    </concat>
    <copy todir="firefox/content/web-developer/generated/javascript">
      <fileset dir="../source/common/javascript/generated">
     		<exclude name="common.js"/>
     		<exclude name="view-cookie-information.js"/>
      </fileset>
    </copy>
    <concat destfile="firefox/content/web-developer/generated/common.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/font-awesome.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/generated/common.css"/>
    </concat>
    <concat destfile="firefox/content/web-developer/generated/syntax-highlight.css">
    	<fileset file="../source/common/style-sheets/common/codemirror/codemirror.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/theme.css"/>
    </concat>
    <copy file="../images/common/logos/16.png" tofile="firefox/content/web-developer/generated/images/favicon.png"/>
    <copy file="../images/common/logos/monochrome.png" tofile="firefox/content/web-developer/generated/images/logo.png"/>
    <copy todir="firefox/content/web-developer/generated/fonts">
      <fileset dir="../source/common/fonts"/>
    </copy>
	</target>

  <!-- Builds the icons for Firefox -->
  <target name="build.firefox.icons" depends="initialize.firefox">
    <echo level="info" message="Building the icons"/>
    <copy file="../images/common/logos/48.png" tofile="firefox/content/web-developer/icons/48.png"/>
    <copy file="../images/common/logos/64.png" tofile="firefox/content/web-developer/icons/64.png"/>
	</target>

  <!-- Builds the locales for Firefox -->
  <target name="build.firefox.locales" depends="initialize.firefox">
    <echo level="info" message="Building the locales"/>
    <copy todir="firefox/locale">
      <fileset dir="../source/firefox/locales"/>
      <filterset refid="firefox.filters"/>
    </copy>
	</target>

  <!-- Builds the options for Firefox -->
  <target name="build.firefox.options" depends="initialize.firefox">
    <echo level="info" message="Building the options"/>
    <copy todir="firefox/content/web-developer/options">
      <fileset dir="../source/firefox/xul/options"/>
    </copy>
    <copy file="../source/common/html/options/syntax-highlight.html" tofile="firefox/content/web-developer/options/html/syntax-highlight.html">
      <filterset refid="firefox.filters"/>
    </copy>
    <copy file="../source/firefox/javascript/options/options.js" tofile="firefox/content/web-developer/options/javascript/options.js"/>
    <copy todir="firefox/content/web-developer/options/dialogs/javascript">
      <fileset dir="../source/firefox/javascript/options/dialogs"/>
    </copy>
    <concat destfile="firefox/content/web-developer/options/html/javascript/syntax-highlight.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/codemirror.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/css.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/htmlmixed.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/javascript.js"/>
    	<fileset file="../source/common/javascript/common/codemirror/xml.js"/>
    	<fileset file="../source/common/javascript/options/syntax-highlight.js"/>
    </concat>
    <copy file="../source/firefox/style-sheets/options/options.css" tofile="firefox/content/web-developer/options/style-sheets/options.css"/>
    <concat destfile="firefox/content/web-developer/options/html/syntax-highlight.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/codemirror.css"/>
    	<fileset file="../source/common/style-sheets/common/codemirror/theme.css"/>
    	<fileset file="../source/common/style-sheets/options/syntax-highlight.css"/>
    </concat>
	</target>

  <!-- Builds the overlay for Firefox -->
  <target name="build.firefox.overlay" depends="initialize.firefox">
    <echo level="info" message="Building the overlay"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="cookies"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.cookies" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="css"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.css" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="disable"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.disable" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="forms"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.forms" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="images"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.images" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="information"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.information" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="miscellaneous"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.miscellaneous" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="options"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.options" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="outline"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.outline" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="resize"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.resize" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="tools"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.tools" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="view-source"/>
    	<param name="menu.suffix" value="app-menu"/>
  	</antcallback>
		<property name="app.menu.view.source" value="${menu}"/>
  	<var name="menu" unset="true"/>

  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="cookies"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.cookies" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="css"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.css" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="disable"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.disable" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="forms"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.forms" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="images"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.images" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="information"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.information" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="miscellaneous"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.miscellaneous" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="options"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.options" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="outline"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.outline" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="resize"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.resize" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="tools"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.tools" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="view-source"/>
    	<param name="menu.suffix" value="context"/>
  	</antcallback>
		<property name="context.view.source" value="${menu}"/>
  	<var name="menu" unset="true"/>

  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="cookies"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.cookies" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="css"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.css" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="disable"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.disable" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="forms"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.forms" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="images"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.images" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="information"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.information" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="miscellaneous"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.miscellaneous" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="options"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.options" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="outline"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.outline" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="resize"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.resize" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="tools"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.tools" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="view-source"/>
    	<param name="menu.suffix" value="menu"/>
  	</antcallback>
		<property name="menu.view.source" value="${menu}"/>
  	<var name="menu" unset="true"/>

		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="cookies"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.cookies" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="css"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.css" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="disable"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.disable" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="forms"/>
			<param name="seamonkey.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.forms" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="images"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.images" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="information"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.information" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="miscellaneous"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.miscellaneous" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="options"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.options" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="outline"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.outline" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="resize"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.resize" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="tools"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.tools" value="${menu}"/>
		<var name="menu" unset="true"/>
		<antcallback target="build.firefox.overlay.menu" return="menu">
			<param name="menu.name" value="view-source"/>
			<param name="menu.suffix" value="seamonkey"/>
		</antcallback>
		<property name="seamonkey.view.source" value="${menu}"/>
		<var name="menu" unset="true"/>

  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="cookies"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.cookies" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="css"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.css" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="disable"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.disable" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="forms"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.forms" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="images"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.images" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="information"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.information" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="miscellaneous"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.miscellaneous" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="options"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.options" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="outline"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.outline" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="resize"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.resize" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="tools"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.tools" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="view-source"/>
    	<param name="menu.suffix" value="toolbar"/>
  	</antcallback>
		<property name="toolbar.view.source" value="${menu}"/>
  	<var name="menu" unset="true"/>

  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="cookies"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.cookies" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="css"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.css" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="disable"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.disable" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="forms"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.forms" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="images"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.images" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="information"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.information" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="miscellaneous"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.miscellaneous" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="options"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.options" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="outline"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.outline" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="resize"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.resize" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="tools"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.tools" value="${menu}"/>
  	<var name="menu" unset="true"/>
  	<antcallback target="build.firefox.overlay.menu" return="menu">
    	<param name="menu.name" value="view-source"/>
    	<param name="menu.suffix" value="toolbar-buttton"/>
  	</antcallback>
		<property name="toolbar.button.view.source" value="${menu}"/>
  	<var name="menu" unset="true"/>

    <copy file="../source/firefox/xul/overlay/overlay.xul" tofile="firefox/content/web-developer/overlay/overlay.xul">
		  <filterchain>
		    <expandproperties/>
		  </filterchain>
    </copy>

    <concat destfile="firefox/content/web-developer/locales/locales.js">
    	<fileset file="../source/common/javascript/locales/locales.js"/>
    	<fileset file="../source/firefox/javascript/locales/locales.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/overlay/javascript/overlay.temp">
      <fileset dir="../source/common/javascript/features"/>
      <fileset dir="../source/common/javascript/overlay"/>
    	<fileset dir="../source/common/javascript/toolbar">
     		<exclude name="**/html/**"/>
    	</fileset>
      <fileset dir="../source/common/javascript/upgrade"/>
      <fileset dir="../source/firefox/javascript/application"/>
      <fileset dir="../source/firefox/javascript/features"/>
      <fileset dir="../source/firefox/javascript/overlay"/>
    	<fileset dir="../source/firefox/javascript/toolbar"/>
      <fileset dir="../source/firefox/javascript/upgrade"/>
      <fileset dir="../source/firefox/javascript/validation"/>
    </concat>
    <move file="firefox/content/web-developer/overlay/javascript/overlay.temp" tofile="firefox/content/web-developer/overlay/javascript/overlay.js">
      <filterset refid="firefox.filters"/>
    </move>
    <copy file="../source/firefox/style-sheets/overlay/overlay.css" tofile="firefox/content/web-developer/overlay/style-sheets/overlay.css"/>
	</target>

  <!-- Builds the overlay menu for Firefox -->
  <target name="build.firefox.overlay.menu">
  	<property name="suffix" value="${menu.suffix}"/>
		<loadfile property="menu" srcFile="../source/firefox/xul/overlay/menus/${menu.name}.xul">
		  <filterchain>
		    <expandproperties/>
		  </filterchain>
		</loadfile>
 	</target>

  <!-- Builds the skins for Firefox -->
  <target name="build.firefox.skins" depends="initialize.firefox">
    <echo level="info" message="Building the skins"/>
    <copy file="../source/firefox/style-sheets/skin/common.css" tofile="firefox/skin/default/web-developer.css"/>
    <concat destfile="firefox/skin/mac/web-developer.css">
    	<fileset file="../source/firefox/style-sheets/skin/common.css"/>
    	<fileset file="../source/firefox/style-sheets/skin/mac.css"/>
    </concat>
    <copy todir="firefox/skin">
      <fileset dir="../images/firefox/skins"/>
    </copy>
    <copy file="../images/common/logos/16.png" tofile="firefox/skin/default/menu.png"/>
    <copy file="../images/common/logos/monochrome.png" tofile="firefox/skin/mac/button.png"/>
    <copy file="../images/common/logos/monochrome.png" tofile="firefox/skin/mac/menu.png"/>
    <copy file="../images/common/toolbar.png" tofile="firefox/skin/default/toolbar.png"/>
    <copy file="../images/firefox/skins/default/options.png" tofile="firefox/skin/mac/options.png"/>
	</target>

  <!-- Builds the toolbars for Firefox -->
  <target name="build.firefox.toolbars" depends="initialize.firefox">
    <echo level="info" message="Building the toolbars"/>
    <copy file="../source/firefox/html/toolbar/element-ancestors.html" tofile="firefox/content/web-developer/toolbar/html/element-ancestors.html">
    	<filterset refid="firefox.filters"/>
    </copy>
    <concat destfile="firefox/content/web-developer/toolbar/html/javascript/element-ancestors.js">
    	<fileset file="../source/common/javascript/common/jquery/jquery.js"/>
    	<fileset file="../source/common/javascript/generated/common.js"/>
    	<fileset file="../source/common/javascript/toolbar/html/element-ancestors.js"/>
    </concat>
    <concat destfile="firefox/content/web-developer/toolbar/html/element-ancestors.css">
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap.css"/>
    	<fileset file="../source/common/style-sheets/common/bootstrap/bootstrap-responsive.css"/>
    	<fileset file="../source/common/style-sheets/common/common.css"/>
    	<fileset file="../source/common/style-sheets/toolbar/html/element-ancestors.css"/>
    </concat>
    <copy todir="firefox/content/web-developer/toolbar">
      <fileset dir="../source/common/style-sheets/toolbar"/>
    </copy>
    <copy file="../images/common/logos/16.png" tofile="firefox/content/web-developer/toolbar/images/logo.png"/>
	</target>

  <!-- Cleans up the build for Chrome -->
  <target name="clean.chrome" depends="initialize.chrome">
    <echo level="info" message="Cleaning up the build for Chrome"/>
  	<delete dir="chrome"/>
  	<delete file="web-developer-chrome.zip"/>
  </target>

  <!-- Cleans up the build for Firefox -->
  <target name="clean.firefox" depends="initialize.firefox">
    <echo level="info" message="Cleaning up the build for Firefox"/>
  	<delete dir="firefox"/>
  	<delete dir="temp-firefox"/>
  	<delete file="web-developer-firefox.xpi"/>
  </target>

  <!-- Converts spaces to tabs in the extension -->
  <target name="convert.spaces.tabs">
    <echo level="info" message="Converting spaces to tabs"/>
		<fixcrlf srcdir="../source/chrome/javascript" excludes="**/options/tablednd.js" tab="add" tablength="2"/>
		<fixcrlf srcdir="../source/common/javascript" excludes="**/beautify/beautify.js,**/bootstrap/collapse.js,**/bootstrap/dropdown.js,**/bootstrap/modal.js,**/bootstrap/tab.js,**/bootstrap/transition.js,**/codemirror/codemirror.js,**/codemirror/css.js,**/codemirror/htmlmixed.js,**/codemirror/javascript.js,**/codemirror/searchcursor.js,**/jquery/icanhaz.js,**/jquery/jquery.js,**/codemirror/xml.js" tab="add" tablength="2"/>
		<fixcrlf srcdir="../source/firefox/javascript" tab="add" tablength="2"/>
 	</target>

  <!-- Initializes the settings -->
  <target name="initialize">
    <tstamp>
      <format property="build.date" pattern="MMMM d, yyyy"/>
    </tstamp>
  </target>

  <!-- Initializes the settings for Chrome -->
  <target name="initialize.chrome" depends="initialize">
    <filterset id="chrome.filters">
      <filter token="build.date" value="${build.date}"/>
      <filtersfile file="../configuration/common/configuration.properties"/>
      <filtersfile file="../configuration/chrome/configuration.properties"/>
    </filterset>
	</target>

  <!-- Initializes the settings for Firefox -->
  <target name="initialize.firefox" depends="initialize">
    <filterset id="firefox.filters">
      <filter token="build.date" value="${build.date}"/>
      <filtersfile file="../configuration/common/configuration.properties"/>
      <filtersfile file="../configuration/firefox/configuration.properties"/>
    </filterset>
	</target>

  <!-- Merges in Bootstrap -->
  <target name="merge.bootstrap">
    <echo level="info" message="Merging Bootstrap into the source"/>
		<copy file="../merge/twitter-bootstrap/js/bootstrap-collapse.js" tofile="../source/common/javascript/common/bootstrap/collapse.js"/>
		<copy file="../merge/twitter-bootstrap/js/bootstrap-dropdown.js" tofile="../source/common/javascript/common/bootstrap/dropdown.js"/>
		<copy file="../merge/twitter-bootstrap/js/bootstrap-modal.js" tofile="../source/common/javascript/common/bootstrap/modal.js"/>
		<copy file="../merge/twitter-bootstrap/js/bootstrap-popover.js" tofile="../source/common/javascript/common/bootstrap/popover.js"/>
		<copy file="../merge/twitter-bootstrap/js/bootstrap-tab.js" tofile="../source/common/javascript/common/bootstrap/tab.js"/>
		<copy file="../merge/twitter-bootstrap/js/bootstrap-tooltip.js" tofile="../source/common/javascript/common/bootstrap/tooltip.js"/>
		<copy file="../merge/twitter-bootstrap/js/bootstrap-transition.js" tofile="../source/common/javascript/common/bootstrap/transition.js"/>
		<copy todir="../source/common/style-sheets/common/bootstrap">
    	<fileset file="../merge/bootstrap/css/bootstrap.css"/>
    	<fileset file="../merge/bootstrap/css/bootstrap-responsive.css"/>
    </copy>
  </target>

  <!-- Merges in CodeMirror -->
  <target name="merge.codemirror">
    <echo level="info" message="Merging CodeMirror into the source"/>
		<copy todir="../source/common/javascript/common/codemirror">
    	<fileset file="../merge/codemirror/lib/codemirror.js"/>
    	<fileset file="../merge/codemirror/lib/util/searchcursor.js"/>
    	<fileset file="../merge/codemirror/mode/css/css.js"/>
    	<fileset file="../merge/codemirror/mode/htmlmixed/htmlmixed.js"/>
    	<fileset file="../merge/codemirror/mode/javascript/javascript.js"/>
    	<fileset file="../merge/codemirror/mode/xml/xml.js"/>
    </copy>
		<copy file="../merge/codemirror/lib/codemirror.css" tofile="../source/common/style-sheets/common/codemirror/codemirror.css"/>
  </target>

  <!-- Merges in Font Awesome -->
  <target name="merge.fontawesome">
    <echo level="info" message="Merging Font Awesome into the source"/>
		<copy file="../merge/fontawesome/css/font-awesome.css" tofile="../source/common/style-sheets/common/bootstrap/font-awesome.css"/>
		<replace file="../source/common/style-sheets/common/bootstrap/font-awesome.css" token="/stylesheets/fonts/../font/fontawesome-webfont" value="fonts/fontawesome-webfont"/>
		<replace file="../source/common/style-sheets/common/bootstrap/font-awesome.css" token="../font/fontawesome-webfont" value="fonts/fontawesome-webfont"/>
    <copy todir="../source/common/fonts">
      <fileset dir="../merge/fontawesome/font"/>
    </copy>
  </target>

  <!-- Packages the extension for Chrome -->
  <target name="package.chrome" depends="build.chrome" description="Packages the extension for Chrome">
    <echo level="info" message="Packaging the extension for Chrome"/>
    <zip destfile="web-developer-chrome.zip">
      <zipfileset dir="chrome"/>
      <zipfileset file="license.txt"/>
    </zip>
  </target>

  <!-- Test the extension -->
  <target name="test" depends="convert.spaces.tabs">
    <echo level="info" message="Running JSLint"/>
		<jslint haltOnFailure="false" options="browser,forin,indent=2,maxerr=100,undef">
    	<formatter type="plain"/>
    	<predef>$$,BrowserPageInfo,BrowserReload,BrowserViewSourceOfDocument,chrome,CodeMirror,Components,CSSPrimitiveValue,getWebNavigation,HTMLDocument,ich,Image,inspectDOMDocument,js_beautify,Node,NodeFilter,pref,toJavaScriptConsole,WebDeveloper,WebDeveloperApplication,WebDeveloperValidateCSS,WebDeveloperValidateHTML,window</predef>
    	<fileset dir="../source/chrome/javascript" excludes="**/options/tablednd.js"/>
    	<fileset dir="../source/common/javascript" excludes="**/beautify/beautify.js,**/bootstrap/collapse.js,**/bootstrap/dropdown.js,**/bootstrap/modal.js,**/bootstrap/popover.js,**/bootstrap/tab.js,**/bootstrap/tooltip.js,**/bootstrap/transition.js,**/codemirror/codemirror.js,**/codemirror/css.js,**/codemirror/htmlmixed.js,**/codemirror/javascript.js,**/codemirror/searchcursor.js,**/jquery/icanhaz.js,**/jquery/jquery.js,**/codemirror/xml.js"/>
    	<fileset dir="../source/firefox/javascript"/>
  	</jslint>
 	</target>
</project>